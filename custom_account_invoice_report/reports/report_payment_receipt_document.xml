<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <template id="report_payment_document_inherit_custom" inherit_id="account.report_payment_receipt_document">
            <xpath expr="//h3" position="after">
                <!--Datos del cliente y fiscales-->
                <!--___________________________________________________________-->
                <table class="table-borderless" width="100%">
                    <tr style="padding-top: 0px;!important">
                        <th class="border-o" colspan="3">
                            <table width="100%">
                                <thead>
                                    <tr style="font-size: 14px;margin-top: 10px;!important;">
                                        <th t-if="o.company_id.vat" style="padding-bottom: 5px;!important"
                                            class="text-start border-o" t-esc="'RFC: ' + o.company_id.vat"/>
                                        <th class="text-start border-o"
                                            t-esc="'Regimen fiscal: ({}) {}'.format(o.company_id.l10n_mx_edi_fiscal_regime, dict(o.company_id._fields['l10n_mx_edi_fiscal_regime']._description_selection(o.env)).get(o.company_id.l10n_mx_edi_fiscal_regime))"/>
                                    </tr>
                                </thead>
                            </table>
                        </th>
                    </tr>
                    <tr>
                        <td class="border-o"/>
                        <td class="border-o" width="50%"
                            style="border-left: 1px solid #000;padding-left: 10px;!important">
                            <table style="margin-top: 10px;!important" width="100%">
                                <thead>
                                    <tr style="font-size: 16px;">
                                        <th colspan="2" class="text-center border-o">Datos del cliente</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="border-o" style="font-size: 12px;">
                                            <strong t-esc="o.partner_id.name"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="border-o" style="font-size: 12px;">
                                            <strong t-esc="'RFC: {}'.format(o.partner_id.vat)"/>
                                        </td>
                                    </tr>

                                    <t t-set="invoice_usage" t-esc="o.reconciled_invoice_ids"/>
                                    <t t-if="invoice_usage">
                                        <tr>
                                            <td style="font-size: 12px;">
                                                <strong t-esc="'Uso de CFDI:' "/>
                                                <span t-esc="'({}) {}'.format(invoice_usage[0].l10n_mx_edi_usage, dict(invoice_usage._fields['l10n_mx_edi_usage']._description_selection(o.env)).get(invoice_usage[0].l10n_mx_edi_usage))"/>
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </td>

                        <td width="50%"
                            style="border-left: 1px solid #000;border-right: 1px solid #000;padding-left: 10px;padding-right: 10px;!important">
                            <table width="100%">
                                <thead>
                                    <tr style="font-size: 16px;">
                                        <th colspan="2" class="text-center border-o">Comprobante fiscal
                                            digital
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="border-o" colspan="2" width="100%" style="font-size: 12px;">
                                            <strong t-esc="'Fecha y hora:' "/>
                                            <span t-esc="o.date"/>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="border-o" colspan="2" width="100%" style="font-size: 12px;">
                                            <strong t-esc="'Lugar de expedición:' "/>
                                            <span t-esc="o.company_id.zip"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                    </tr>
                </table>
                <!--___________________________________________________________-->
            </xpath>

            <xpath expr="//div/div" position="inside">
                <div class="row">
                    <div class="col-6" t-if="o.currency_id">
                        Moneda de pago: <span t-esc="o.currency_id.name"/>
                    </div>
                </div>
            </xpath>
        </template>

        <template id="report_payment_document_inherit_custom_mx" inherit_id="l10n_mx_edi.report_payment_document_mx">
            <xpath expr="//table[2]//thead//th[7]" position="after">
                <th>Método de pago</th>
            </xpath>

            <xpath expr="//table[2]//tbody//td[7]" position="after">
                <td style="text-align:center;"><span
                        t-esc="o.reconciled_invoice_ids.filtered(lambda i: i.l10n_mx_edi_cfdi_uuid == inv.get('IdDocumento')).l10n_mx_edi_payment_policy or ''"/></td>
            </xpath>
        </template>


    </data>
</odoo>